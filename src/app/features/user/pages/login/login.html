<div
  class="min-h-screen transition-colors duration-300"
  [ngClass]="{
    'bg-gray-900': isDarkMode,
    'bg-green-50': !isDarkMode
  }"
>
  <!-- Spinner -->
  <app-spinner [isLoading]="isLoading"></app-spinner>

  <!-- Skeleton for Initial Loading -->
  @if (isFirstLoading) {
    <div class="py-5 mx-auto w-11/12 max-w-lg">
      <div class="h-8 w-48 bg-gray-300 rounded animate-pulse" [ngClass]="{
          'bg-gray-600': isDarkMode,
          'bg-gray-300': !isDarkMode
        }"></div>
      <div class="px-10 py-8 space-y-5">
        <div class="h-10 w-full bg-gray-300 rounded animate-pulse" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
        <div class="h-10 w-full bg-gray-300 rounded animate-pulse" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
        <div class="h-4 w-32 bg-gray-300 rounded animate-pulse ml-auto" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
        <div class="h-10 w-full bg-gray-300 rounded-lg animate-pulse" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
      </div>
    </div>
  } @else {
    <div class="py-5 mx-auto w-11/12 max-w-lg">
      <h2
        class="text-4xl"
        [ngClass]="{
          'text-green-400': isDarkMode,
          'text-emerald-500': !isDarkMode
        }"
      >
        Login Form
      </h2>

      <form
        (ngSubmit)="handleSubmit()"
        [formGroup]="loginForm"
        class="px-10 mx-auto py-8"
      >
        <!-- Email -->
        <div class="relative z-0 w-full mb-5 group">
          <input
            formControlName="email"
            type="email"
            class="block py-2.5 px-2 w-full text-sm border-0 border-b-2 appearance-none focus:outline-none focus:ring-0 peer"
            [ngClass]="{
              'rounded-xl text-black bg-emerald-200 border-gray-600 focus:border-green-400': isDarkMode,
              'text-cyan-950 bg-transparent border-gray-300 focus:border-green-500': !isDarkMode
            }"
            placeholder=" "
            required
          />
          <label
            for="floating_email"
            class="px-2 peer-focus:font-medium absolute text-sm duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
            [ngClass]="{
              'text-gray-400 z-10 peer-focus:text-green-400': isDarkMode,
              'text-gray-500 peer-focus:text-green-600': !isDarkMode
            }"
          >
            Email
          </label>
          @if(getEmailController?.touched) {
            @if(getEmailController?.getError('required')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Email is required</div>
                </div>
              </div>
            }
            @if(getEmailController?.getError('email')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Email is invalid</div>
                </div>
              </div>
            }
          }
        </div>

        <!-- Password -->
        <div class="relative z-0 w-full mb-5 group">
          <input
            formControlName="password"
            type="password"
            class="block py-2.5 px-2 w-full text-sm border-0 border-b-2 appearance-none focus:outline-none focus:ring-0 peer"
            [ngClass]="{
              'rounded-xl text-black bg-emerald-200 border-gray-600 focus:border-green-400': isDarkMode,
              'text-cyan-950 bg-transparent border-gray-300 focus:border-green-500': !isDarkMode
            }"
            placeholder=" "
            required
          />
          <label
            for="floating_password"
            class="px-2 peer-focus:font-medium absolute text-sm duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
            [ngClass]="{
              'text-gray-400 z-10 peer-focus:text-green-400': isDarkMode,
              'text-gray-500 peer-focus:text-green-600': !isDarkMode
            }"
          >
            Password
          </label>
          @if(getPasswordController?.touched) {
            @if(getPasswordController?.getError('required')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Password is required</div>
                </div>
              </div>
            }
          }
        </div>

        <!-- Forgot Password Link -->
        <div class="text-right mb-5">
          <a
            routerLink="/reset-password"
            class="text-sm hover:underline"
            [ngClass]="{
              'text-green-400 hover:text-green-500': isDarkMode,
              'text-green-600 hover:text-green-800': !isDarkMode
            }"
          >
            Forgot your password?
          </a>
        </div>

        <!-- Submit -->
        <button
          [disabled]="loginForm.invalid || isLoading"
          type="submit"
          class="disabled:opacity-50 text-white font-medium rounded-lg text-sm w-full px-5 py-2.5 text-center transition duration-300"
          [ngClass]="{
            'bg-green-600 hover:bg-green-700 focus:ring-green-500': isDarkMode,
            'bg-green-700 hover:bg-green-800 focus:ring-green-300': !isDarkMode
          }"
        >
          @if(isLoading) {
            <span>Loading...</span>
          } @else {
            <span>Login</span>
          }
        </button>
      </form>
    </div>
  }
</div>