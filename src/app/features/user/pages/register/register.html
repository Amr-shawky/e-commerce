<div
  class="min-h-screen transition-colors duration-300"
  [ngClass]="{
    'bg-gray-900': isDarkMode,
    'bg-green-50': !isDarkMode
  }"
>
  <!-- Spinner -->
  <app-spinner [isLoading]="isLoading"></app-spinner>

  <!-- Skeleton for Initial Loading -->
  @if (isFirstLoading) {
    <div class="py-5 mx-auto w-11/12 max-w-lg">
      <div class="h-8 w-48 bg-gray-300 rounded animate-pulse" [ngClass]="{
          'bg-gray-600': isDarkMode,
          'bg-gray-300': !isDarkMode
        }"></div>
      <div class="px-10 py-8 space-y-5">
        <div class="h-10 w-full bg-gray-300 rounded animate-pulse" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
        <div class="h-10 w-full bg-gray-300 rounded animate-pulse" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
        <div class="h-10 w-full bg-gray-300 rounded animate-pulse" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
        <div class="h-10 w-full bg-gray-300 rounded animate-pulse" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
        <div class="h-10 w-full bg-gray-300 rounded animate-pulse" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
        <div class="h-10 w-full bg-gray-300 rounded-lg animate-pulse" [ngClass]="{
            'bg-gray-600': isDarkMode,
            'bg-gray-300': !isDarkMode
          }"></div>
      </div>
    </div>
  } @else {
    <div class="py-5 mx-auto w-11/12 max-w-lg">
      <h2
        class="text-4xl"
        [ngClass]="{
          'text-green-400': isDarkMode,
          'text-emerald-500': !isDarkMode
        }"
      >
        Register Form
      </h2>

      <form
        (ngSubmit)="handlesubmit()"
        [formGroup]="registerform"
        class="px-10 mx-auto py-8"
      >
        <!-- Name -->
        <div class="relative z-0 w-full mb-5 group">
          <input
            formControlName="name"
            type="text"
            class="block py-2.5 px-2 w-full text-sm border-0 border-b-2 appearance-none focus:outline-none focus:ring-0 peer"
            [ngClass]="{
              'rounded-xl text-black bg-emerald-200 border-gray-600 focus:border-green-400': isDarkMode,
              'text-cyan-950 bg-transparent border-gray-300 focus:border-green-500': !isDarkMode
            }"
            placeholder=" "
            required
          />
          <label
            for="floating_name"
            class="px-2 peer-focus:font-medium absolute text-sm duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
            [ngClass]="{
              'text-gray-400 z-10 peer-focus:text-green-400': isDarkMode,
              'text-gray-500 peer-focus:text-green-600': !isDarkMode
            }"
          >
            Name
          </label>
          @if(getnamecontroller?.touched) {
            @if(getnamecontroller?.getError('required')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Name is required</div>
                </div>
              </div>
            }
            @if(getnamecontroller?.getError('pattern') || getnamecontroller?.getError('minlength')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Name is invalid</div>
                </div>
              </div>
            }
          }
        </div>

        <!-- Email -->
        <div class="relative z-0 w-full mb-5 group">
          <input
            formControlName="email"
            type="email"
              class="block py-2.5 px-2 w-full text-sm border-0 border-b-2 appearance-none focus:outline-none focus:ring-0 peer"
            [ngClass]="{
              'rounded-xl text-black bg-emerald-200 border-gray-600 focus:border-green-400': isDarkMode,
              'text-cyan-950 bg-transparent border-gray-300 focus:border-green-500': !isDarkMode
            }"
            placeholder=" "
            required
          />
          <label
            for="floating_email"
            class="px-2 peer-focus:font-medium absolute text-sm duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
            [ngClass]="{
              'text-gray-400 z-10 peer-focus:text-green-400': isDarkMode,
              'text-gray-500 peer-focus:text-green-600': !isDarkMode
            }"
          >
            Email
          </label>
          @if(getemailcontroller?.touched) {
            @if(getemailcontroller?.getError('required')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Email is required</div>
                </div>
              </div>
            }
            @if(getemailcontroller?.getError('email')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Email is invalid</div>
                </div>
              </div>
            }
          }
        </div>

        <!-- Password -->
        <div class="relative z-0 w-full mb-5 group">
          <input
            formControlName="password"
            type="password"
               class="block py-2.5 px-2 w-full text-sm border-0 border-b-2 appearance-none focus:outline-none focus:ring-0 peer"
            [ngClass]="{
              'rounded-xl text-black bg-emerald-200 border-gray-600 focus:border-green-400': isDarkMode,
              'text-cyan-950 bg-transparent border-gray-300 focus:border-green-500': !isDarkMode
            }"
            placeholder=" "
            required
          />
          <label
            for="floating_password"
            class="px-2 peer-focus:font-medium absolute text-sm duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
            [ngClass]="{
              'text-gray-400 z-10 peer-focus:text-green-400': isDarkMode,
              'text-gray-500 peer-focus:text-green-600': !isDarkMode
            }"
          >
            Password
          </label>
          @if(getpasswordcontroller?.touched) {
            @if(getpasswordcontroller?.getError('required')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Password is required</div>
                </div>
              </div>
            }
            @if(getpasswordcontroller?.getError('pattern')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Password must be at least 8 characters, include uppercase, lowercase, number, and special character</div>
                </div>
              </div>
            }
          }
        </div>

        <!-- Re-Password -->
        <div class="relative z-0 w-full mb-5 group">
          <input
            formControlName="rePassword"
            type="password"
               class="block py-2.5 px-2 w-full text-sm border-0 border-b-2 appearance-none focus:outline-none focus:ring-0 peer"
            [ngClass]="{
              'rounded-xl text-black bg-emerald-200 border-gray-600 focus:border-green-400': isDarkMode,
              'text-cyan-950 bg-transparent border-gray-300 focus:border-green-500': !isDarkMode
            }"
            placeholder=" "
            required
          />
          <label
            for="floating_rePassword"
            class="px-2 peer-focus:font-medium absolute text-sm duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
            [ngClass]="{
              'text-gray-400 z-10 peer-focus:text-green-400': isDarkMode,
              'text-gray-500 peer-focus:text-green-600': !isDarkMode
            }"
          >
            RePassword
          </label>
          @if(getrePasswordcontroller?.touched) {
            @if(registerform.errors?.['mismatch'] && getrePasswordcontroller?.touched) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Passwords do not match</div>
                </div>
              </div>
            }
          }
        </div>

        <!-- Phone -->
        <div class="relative z-0 w-full mb-5 group">
          <input
            formControlName="phone"
            type="text"
                class="block py-2.5 px-2 w-full text-sm border-0 border-b-2 appearance-none focus:outline-none focus:ring-0 peer"
            [ngClass]="{
              'rounded-xl text-black bg-emerald-200 border-gray-600 focus:border-green-400': isDarkMode,
              'text-cyan-950 bg-transparent border-gray-300 focus:border-green-500': !isDarkMode
            }"
            placeholder=" "
          />
          <label
            for="floating_phone"
            class="px-2 peer-focus:font-medium absolute text-sm duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
            [ngClass]="{
              'text-gray-400 z-10 peer-focus:text-green-400': isDarkMode,
              'text-gray-500 peer-focus:text-green-600': !isDarkMode
            }"
          >
            Phone
          </label>
          @if(getphonecontroller?.touched) {
            @if(getphonecontroller?.getError('required')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Phone is required</div>
                </div>
              </div>
            }
            @if(getphonecontroller?.getError('pattern')) {
              <div
                class="mb-3"
                [ngClass]="{
                  'text-red-400': isDarkMode,
                  'text-red-600': !isDarkMode
                }"
              >
                <div
                  class="transition duration-300 flex items-center p-4 mb-4 text-sm border rounded-lg"
                  [ngClass]="{
                    'text-red-400 border-red-600 bg-red-900/20': isDarkMode,
                    'text-red-800 border-red-300 bg-red-50': !isDarkMode
                  }"
                  role="alert"
                >
                  <i class="fas fa-exclamation-circle shrink-0 inline w-4 h-4 me-3"></i>
                  <span class="sr-only">Info</span>
                  <div>Phone is invalid</div>
                </div>
              </div>
            }
          }
        </div>

        <!-- Submit -->
        <button
          [disabled]="registerform.invalid || isLoading"
          type="submit"
          class="disabled:opacity-50 text-white font-medium rounded-lg text-sm w-full px-5 py-2.5 text-center transition duration-300"
          [ngClass]="{
            'bg-green-600 hover:bg-green-700 focus:ring-green-500': isDarkMode,
            'bg-green-700 hover:bg-green-800 focus:ring-green-300': !isDarkMode
          }"
        >
          @if(isLoading) {
            <span>Loading...</span>
          } @else {
            <span>Submit</span>
          }
        </button>
      </form>
    </div>
  }
</div>